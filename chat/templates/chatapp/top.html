{% extends "chatapp/base.html" %}
{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/top.css' %}">
<div class="container">
  <h3 class=" text-center">Messaging</h3>
  <div class="messaging">
        <div class="inbox_msg">
          <div class="inbox_people">
            <div class="headind_srch">
              <div class="recent_heading">
                <h4>Recent</h4>
              </div>
              <div class="srch_bar">
                <div class="stylish-input-group">
                  <input type="text" class="search-bar"  placeholder="Search" >
                  <span class="input-group-addon">
                  <button type="button"> <i class="fa fa-search" aria-hidden="true"></i> </button>
                  </span> </div>
              </div>
            </div>
            <div class="inbox_chat">
              {% for room in my_rooms %}
              <div class="chat_list active_chat">
                <div class="chat_people">
                  <div class="chat_img">
                    <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil">
                  </div>
                  <div class="chat_ib">
                    <h5><button room_id="{{ room.room.pk }}" type="button" class="btn btn-primary" id="room_btn">{{ room.room.title }}</button><span class="chat_date">{{ room.room.get_latest_message.sent_at }}</span></h5>
                    <p>{{ room.room.get_latest_message.message }}</p>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="mesgs">
            <div class="msg_history">
              
            </div>
            <div id="message_form" class="type_msg" style="display:none">
                <div  class="input-group">
                  <textarea id="chat-message-input" class="form-control" placeholder="message here.."></textarea>
                  <div class="input-group-btn">
                    <button id="send_msg_button" class="btn btn-default" type="submit">
                      <i class="far fa-comment-alt"></i>
                    </button>
                  </div>
                  <form name="file_upload">
                    <div class="input-group-btn">
                      <button name="fileupload" class="btn btn-default" type="button">
                        <i class="fas fa-paperclip"></i>
                      </button>
                    </div>
                    
                    <input id="fileupload" type="file" name="attachment" multiple style="display:none"
                                data-url="{% url 'chatapp:upload' %}"
                                data-form-data='{"csrfmiddlewaretoken": "{{ csrf_token }}"}'>
                  </form>    
                </div>
                <div id="preview_zone"></div>
            </div>
          </div>
        </div>
        
        
        <p class="text-center top_spac"> Design by <a target="_blank" href="#">Sunil Rajput</a></p>
        
      </div></div>
{% endblock %}
{% block extra_js %}

<script>
    var history_url = "{% url 'chatapp:history' %}";
    var login_url = "{% url 'chatapp:login' %}"
    var attachment_url = "{% url 'chatapp:upload' %}";
    var user_pk = '{{ user.pk }}';
    
</script>
<script src="{% static 'js/top.js' %}"></script>
{% endblock %}
